{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/amans/OneDrive/Desktop/react_router/routing-in-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/amans/OneDrive/Desktop/react_router/routing-in-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/amans/OneDrive/Desktop/react_router/routing-in-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState}from'react';import CommentsList from'../comments/CommentsList';import classes from'./Comments.module.css';import NewCommentForm from'./NewCommentForm';import{useEffect,useCallback}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Comments=function Comments(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAddingComment=_useState2[0],setIsAddingComment=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),allcomments=_useState4[0],setAllcommens=_useState4[1];var startAddCommentHandler=function startAddCommentHandler(){setIsAddingComment(function(previous){return!previous;});};var addingComment=function addingComment(comment){var sendingComment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://webapp-e180b-default-rtdb.firebaseio.com/comments/\".concat(props.path,\".json\"),{method:\"POST\",body:JSON.stringify(comment),headers:{'Content-Type':'application/json'}});case 2:case\"end\":return _context.stop();}}},_callee);}));return function sendingComment(){return _ref.apply(this,arguments);};}();try{sendingComment();}catch(err){throw new Error(\"Something went wrong!\");}};var fetchingfromDatabase=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,data,list,key;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"https://webapp-e180b-default-rtdb.firebaseio.com/comments/\".concat(props.path,\".json\"));case 3:response=_context2.sent;if(response.ok){_context2.next=6;break;}throw new Error(\"Something went wrong\");case 6:_context2.next=8;return response.json();case 8:data=_context2.sent;list=[];for(key in data){list.push({id:key,text:data[key].text});}setAllcommens(list);_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[0,14]]);})),[props.path]);useEffect(function(){fetchingfromDatabase();},[fetchingfromDatabase]);return/*#__PURE__*/_jsxs(\"section\",{className:classes.comments,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Comments\"}),!isAddingComment&&/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:startAddCommentHandler,children:\"Add a Comment\"}),isAddingComment&&/*#__PURE__*/_jsx(NewCommentForm,{onAddingComment:addingComment}),/*#__PURE__*/_jsx(\"p\",{children:\"Comments...\"}),/*#__PURE__*/_jsx(CommentsList,{comments:allcomments})]});};export default Comments;","map":{"version":3,"sources":["C:/Users/amans/OneDrive/Desktop/react_router/routing-in-react/src/components/comments/Comments.js"],"names":["useState","CommentsList","classes","NewCommentForm","useEffect","useCallback","Comments","props","isAddingComment","setIsAddingComment","allcomments","setAllcommens","startAddCommentHandler","previous","addingComment","comment","sendingComment","fetch","path","method","body","JSON","stringify","headers","err","Error","fetchingfromDatabase","response","ok","json","data","list","key","push","id","text","console","log","comments"],"mappings":"yhBAAA,OAASA,QAAT,KAAyB,OAAzB,CACA,MAAOC,CAAAA,YAAP,KAAyB,0BAAzB,CACA,MAAOC,CAAAA,OAAP,KAAoB,uBAApB,CACA,MAAOC,CAAAA,cAAP,KAA2B,kBAA3B,CACA,OAASC,SAAT,CAAmBC,WAAnB,KAAsC,OAAtC,C,wFAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,KAAD,CAAW,CAC1B,cAA8CP,QAAQ,CAAC,KAAD,CAAtD,wCAAOQ,eAAP,eAAwBC,kBAAxB,eACA,eAAmCT,QAAQ,CAAC,EAAD,CAA3C,yCAAMU,WAAN,eAAkBC,aAAlB,eACA,GAAMC,CAAAA,sBAAsB,CAAG,QAAzBA,CAAAA,sBAAyB,EAAM,CACnCH,kBAAkB,CAAC,SAAAI,QAAQ,QAAG,CAACA,QAAJ,EAAT,CAAlB,CACD,CAFD,CAGA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,OAAD,CAAW,CAC/B,GAAMC,CAAAA,cAAc,0FAAG,yJACdC,CAAAA,KAAK,qEAA8DV,KAAK,CAACW,IAApE,UAAgF,CAC1FC,MAAM,CAAC,MADmF,CAE1FC,IAAI,CAACC,IAAI,CAACC,SAAL,CAAeP,OAAf,CAFqF,CAG1FQ,OAAO,CAAE,CACP,eAAgB,kBADT,CAHiF,CAAhF,CADS,uDAAH,kBAAdP,CAAAA,cAAc,0CAApB,CASA,GAAG,CACCA,cAAc,GAEjB,CACD,MAAMQ,GAAN,CAAU,CACL,KAAM,IAAIC,CAAAA,KAAJ,CAAW,uBAAX,CAAN,CACJ,CAEJ,CAlBC,CAmBA,GAAMC,CAAAA,oBAAoB,CAAGrB,WAAW,sEAAC,2MAGhBY,CAAAA,KAAK,qEAA8DV,KAAK,CAACW,IAApE,UAHW,QAGjCS,QAHiC,mBAInCA,QAAQ,CAACC,EAJ0B,+BAK7B,IAAIH,CAAAA,KAAJ,CAAU,sBAAV,CAL6B,+BAQpBE,CAAAA,QAAQ,CAACE,IAAT,EARoB,QAQjCC,IARiC,gBAUjCC,IAViC,CAU1B,EAV0B,CAWvC,IAAWC,GAAX,GAAkBF,CAAAA,IAAlB,CAAuB,CACnBC,IAAI,CAACE,IAAL,CAAU,CACNC,EAAE,CAACF,GADG,CAENG,IAAI,CAACL,IAAI,CAACE,GAAD,CAAJ,CAAUG,IAFT,CAAV,EAIH,CACDxB,aAAa,CAACoB,IAAD,CAAb,CAjBuC,qFAmBnCK,OAAO,CAACC,GAAR,eAnBmC,uEAAD,GAsBtC,CAAC9B,KAAK,CAACW,IAAP,CAtBsC,CAAxC,CAuBAd,SAAS,CAAC,UAAI,CACVsB,oBAAoB,GACrB,CAFM,CAEL,CAACA,oBAAD,CAFK,CAAT,CAIA,mBACE,iBAAS,SAAS,CAAExB,OAAO,CAACoC,QAA5B,wBACE,qCADF,CAEG,CAAC9B,eAAD,eACC,eAAQ,SAAS,CAAC,KAAlB,CAAwB,OAAO,CAAEI,sBAAjC,2BAHJ,CAOGJ,eAAe,eAAI,KAAC,cAAD,EAAiB,eAAe,CAAIM,aAApC,EAPtB,cAQE,kCARF,cASE,KAAC,YAAD,EAAe,QAAQ,CAAIJ,WAA3B,EATF,GADF,CAaD,CAjED,CAmEA,cAAeJ,CAAAA,QAAf","sourcesContent":["import { useState } from 'react';\nimport CommentsList from '../comments/CommentsList'\nimport classes from './Comments.module.css';\nimport NewCommentForm from './NewCommentForm';\nimport { useEffect,useCallback } from 'react';\n\nconst Comments = (props) => {\n  const [isAddingComment, setIsAddingComment] = useState(false);\n  const[allcomments,setAllcommens] = useState([])\n  const startAddCommentHandler = () => {\n    setIsAddingComment(previous =>!previous);\n  };\n  const addingComment = (comment)=>{\n    const sendingComment = async()=>{\n       await fetch(`https://webapp-e180b-default-rtdb.firebaseio.com/comments/${props.path}.json`,{\n        method:\"POST\",\n        body:JSON.stringify(comment),\n        headers: {\n          'Content-Type': 'application/json',\n        }\n    })\n}\n    try{\n        sendingComment()\n        \n    }\n    catch(err){\n         throw new Error (\"Something went wrong!\");\n    }   \n   \n}\n  const fetchingfromDatabase = useCallback(async()=>{\n\n    try{\n    const response = await fetch(`https://webapp-e180b-default-rtdb.firebaseio.com/comments/${props.path}.json`)\n    if(!response.ok){\n        throw new Error(\"Something went wrong\")\n    }\n\n    const data = await response.json()\n    \n    const list = []\n    for (const key in data){\n        list.push({\n            id:key,\n            text:data[key].text\n        })\n    }\n    setAllcommens(list)\n}catch(err){\n        console.log(err)\n\n    } \n  },[props.path])\n  useEffect(()=>{\n      fetchingfromDatabase()\n    },[fetchingfromDatabase])\n  \n  return (\n    <section className={classes.comments}>\n      <h2>User Comments</h2>\n      {!isAddingComment && (\n        <button className='btn' onClick={startAddCommentHandler}>\n          Add a Comment\n        </button>\n      )}\n      {isAddingComment && <NewCommentForm  onAddingComment = {addingComment}/>}\n      <p>Comments...</p>\n      <CommentsList  comments = {allcomments}    />\n    </section>\n  );\n};\n\nexport default Comments;\n"]},"metadata":{},"sourceType":"module"}